<!DOCTYPE HTML>
<!--
	Alpha by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Erlang Tutorials by Cole Fichter</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="A collection of Erlang/OTP tutorials." />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.dropotron.min.js"></script>
		<script src="js/jquery.scrollgress.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-wide.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
	</head>
	<body>

		<!-- Header -->
			<header id="header" class="skel-layers-fixed">
				<h1><a href="index.html">Erlang Tutorials</a> by Cole Fichter</h1>
				<nav id="nav">
					<ul>
						<li><a href="index.html">Home</a></li>
						<li>
							<a href="" class="icon fa-angle-down">Tutorials</a>
							<ul>
								<!--
								<li><a href="generic.html">Generic</a></li>
								<li><a href="contact.html">Contact</a></li>
								<li><a href="elements.html">Elements</a></li>
								-->
								<li>
									<a href="">MapReduce...</a>
									<ul>
										<li><a href="mapreduce1.html">One (single-node)</a></li>
										<li><a href="mapreduce2.html">Two (clustered)</a></li>
										<li><a href="mapreduce3.html">Three (replication)</a></li>
									</ul>
								</li>
							</ul>
						</li>
						<!--
						<li><a href="#" class="button">Sign Up</a></li>
						-->
					</ul>
				</nav>
			</header>

		<!-- Main -->
			<section id="main" class="container">
				<header>
					<span class="icon major fa-cogs accent2"></span>
					<h2>MapReduce Part Three</h2>
					<p>We add data replication and automatic failover to the multi-node parallel data processing system.</p>
				</header>
				<div class="box">
					<span class="image featured"><img src="images/mapreduce/traffic_cropped.jpg" alt="" /></span>
					<p>In <a href="mapreduce1.html">part one</a> we began by creating a simple MapReduce system that runs on only one node. In <a href="mapreduce1.html">part two</a> we adjusted the system to work with multiple nodes in a cluster. Here, in part three, we'll add data replication and automatic fail-over when nodes crash.</p>

					<p>
						Complete code for this tutorial is available in the <a href="https://github.com/colefichter/DistributedMapReduce3">GitHub repository</a>.
					</p>

					<h3>Recap: What We've Done So Far</h3>

					<p>This tutorial series began by creating a simple parallel data processing system that ran only on a single machine. In that system, we created worker process to store a set of integers and process compute operations over that dataset using the MapReduce paradigm. We then adjusted the system to run on multiple computers, or nodes, in a fully peer-to-peer topology. The decision not to use a master/slave arrangement will now come in handy as we add data replication and automatic fail-over to the system. This will allow the cluster to maintain the data hosted by a node that crashes (and exits the cluster).
					</p>

					<p>On most platforms adding a replication feature like this would be a serious undertaking. Fortunately, Erlang's native message passing and crash signaling between physical nodes will do virtually all of the heavy lifting for us.</p>

					<h3>Replication Basics</h3>

					<p>In this simple replication scheme, each peer will randomly select a replication partner. The peer will send it's partner a full copy of it's partition of the data set and request that the partner keep it safe, and monitor the health of the peer. If the peer should crash or terminate for some reason, the partner will be notified and will bring that peer's data into it's own partition, thus preserving the portion of the dataset that would have been lost when the peer crashed.
					</p>

					<p>To make clear what's going on, let's anthromorphize our servers and pretend that Alice and Bob are MapReduce servers having a conversation about replication:</p>

					<ul>
						<li>Alice: Hi Bob. I've chosen you to be my replication partner. I'll need you to keep a copy of my data safe in case anything happens to my copy.</li>
						<li>Bob: Ok, that sounds great. I'll store your data over here and I'll keep an eye out for you. Let me know if you get in to trouble.</li>
						<li>Alice: Thanks! Will do.</li>
						<li>[Some time goes by...]</li>
						<li>Alice: Hey Bob, I've added the number 12345 to my dataset. Can you update my replica?</li>
						<li>Bob: Ok, it's updated.</li>
						<li>[Some more time goes by... and Alice chokes on an avocado pit and dies!]</li>
						<li>Alice: HELP, HELP, I'M DYING!</li>
						<li>Bob: Oh dear, that's not good. Alas, life must go on. I'll move Alice's replica into my dataset and love it like it was my own.</li>						
					</ul>

					<p>At this point, Bob is now responsible for all of Alice's data, and the cluster has one less node (since Alice has died) so any future writes will be distributed evenly among the remaining peers (including Bob). You'll also note that in the skit above, Alice prudently kept her replica with Bob up-to-date when she added new values to her copy of the data. This an important feature. In our system the initial replication command will send the entire data partition to the replica, and we'll update that replica incrementally by sending new values to the replication partner as they are written.</p>
									
				</div>
			</section>
			
		<!-- Footer -->
			<footer id="footer">
				<ul class="icons">
					<li><a href="https://twitter.com/MathasaurusRex" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
					<li><a href="https://github.com/colefichter" class="icon fa-github"><span class="label">Github</span></a></li>
					<li><a href="http://www.linkedin.com/pub/cole-fichter/4/a5/b20" class="icon fa-linkedin"><span class="label">Twitter</span></a></li>
				</ul>
				<ul class="copyright">
					<li>&copy; Cole Fichter. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
				</ul>
			</footer>

	</body>
</html>
